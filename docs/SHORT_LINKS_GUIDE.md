# üìé –ö–æ—Ä–æ—Ç–∫–∏–µ —Å—Å—ã–ª–∫–∏ –¥–ª—è SMS - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –∫–æ—Ä–æ—Ç–∫–∏–µ —Å—Å—ã–ª–∫–∏, –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ SMS. –û–¥–Ω–∞ —Å—Å—ã–ª–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é –¥–æ–∫—É–º–µ–Ω—Ç–∞.

## –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ü—Ä–∏–Ω—Ü–∏–ø "–û–¥–Ω–∞ —Å—Å—ã–ª–∫–∞ - –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª"

1. **1–° –∑–∞–≥—Ä—É–∂–∞–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª** ‚Üí –ø–æ–ª—É—á–∞–µ—Ç –∫–æ—Ä–æ—Ç–∫—É—é —Å—Å—ã–ª–∫—É
2. **–ö–ª–∏–µ–Ω—Ç –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ —Å—Å—ã–ª–∫–µ** ‚Üí —Å–∫–∞—á–∏–≤–∞–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª
3. **–ö–ª–∏–µ–Ω—Ç –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç –∏ 1–° –∑–∞–≥—Ä—É–∂–∞–µ—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Ñ–∞–π–ª**
4. **–ö–ª–∏–µ–Ω—Ç –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ —Ç–æ–π –∂–µ —Å—Å—ã–ª–∫–µ** ‚Üí —Ç–µ–ø–µ—Ä—å —Å–∫–∞—á–∏–≤–∞–µ—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é

## –§–æ—Ä–º–∞—Ç —Å—Å—ã–ª–æ–∫

### –ö–æ—Ä–æ—Ç–∫–∞—è —Å—Å—ã–ª–∫–∞ (–¥–ª—è SMS)
```
https://doc.yourcompany.ru/abc12345
```
- –í—Å–µ–≥–æ **36 —Å–∏–º–≤–æ–ª–æ–≤** (–≤–∫–ª—é—á–∞—è –¥–æ–º–µ–Ω)
- –ö–æ—Ä–æ—Ç–∫–∏–π ID: 8 —Å–∏–º–≤–æ–ª–æ–≤ (a-z, 0-9)
- –ü–æ–º–µ—â–∞–µ—Ç—Å—è –≤ SMS —Å —Ç–µ–∫—Å—Ç–æ–º

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —Å—Å—ã–ª–∫–∞ (–ø–æ–ª–Ω—ã–π UUID)
```
https://doc.yourcompany.ru/65d694a2-20bf-4df8-bff4-72ef9b7eeb7c
```

## API –ò–∑–º–µ–Ω–µ–Ω–∏—è

### Upload Response (—Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä–æ—Ç–∫–∏–µ —Å—Å—ã–ª–∫–∏)

```json
{
  "contract_id": "65d694a2-20bf-4df8-bff4-72ef9b7eeb7c",
  "short_id": "abc12345",
  "file_url": "https://doc.yourcompany.ru/api/v1/download/65d694a2-20bf-4df8-bff4-72ef9b7eeb7c/original",
  "short_url": "https://doc.yourcompany.ru/abc12345",
  "message": "File uploaded successfully"
}
```

### Sign Response (—Ç–∞ –∂–µ —Å—Å—ã–ª–∫–∞!)

```json
{
  "contract_id": "65d694a2-20bf-4df8-bff4-72ef9b7eeb7c",
  "short_id": "abc12345",
  "signed_file_url": "https://doc.yourcompany.ru/api/v1/download/65d694a2-20bf-4df8-bff4-72ef9b7eeb7c/signed",
  "short_url": "https://doc.yourcompany.ru/abc12345",
  "message": "File signed successfully"
}
```

**–í–∞–∂–Ω–æ:** `short_url` –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω–æ–π!

## Workflow –¥–ª—è 1–°

### –°—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–± (–≤—Å—ë –µ—â—ë —Ä–∞–±–æ—Ç–∞–µ—Ç)
```
1–° ‚Üí POST /api/v1/upload ‚Üí –ø–æ–ª—É—á–∞–µ—Ç file_url
–ü–µ—Ä–µ–¥–∞—á–∞ —Å—Å—ã–ª–∫–∏ –∫–ª–∏–µ–Ω—Ç—É ‚Üí GET file_url
–ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ
1–° ‚Üí POST /api/v1/sign/{id} ‚Üí –ø–æ–ª—É—á–∞–µ—Ç signed_file_url
–ü–µ—Ä–µ–¥–∞—á–∞ —Å—Å—ã–ª–∫–∏ –∫–ª–∏–µ–Ω—Ç—É ‚Üí GET signed_file_url
```

### –ù–æ–≤—ã–π —Å–ø–æ—Å–æ–± (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```
1–° ‚Üí POST /api/v1/upload ‚Üí –ø–æ–ª—É—á–∞–µ—Ç short_url
–ü–µ—Ä–µ–¥–∞—á–∞ —Å—Å—ã–ª–∫–∏ –∫–ª–∏–µ–Ω—Ç—É ‚Üí GET short_url (–æ—Ä–∏–≥–∏–Ω–∞–ª)
–ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ
1–° ‚Üí POST /api/v1/sign/{id} ‚Üí –ø–æ–ª—É—á–∞–µ—Ç —Ç—É –∂–µ short_url
–ö–ª–∏–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—É –∂–µ —Å—Å—ã–ª–∫—É ‚Üí GET short_url (–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π)
```

## –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞

–ü—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ –∫–æ—Ä–æ—Ç–∫–æ–π —Å—Å—ã–ª–∫–µ —Å–∏—Å—Ç–µ–º–∞:

1. **–ò—â–µ—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é** ‚Üí –µ—Å–ª–∏ –µ—Å—Ç—å, –æ—Ç–¥–∞–µ—Ç –µ—ë
2. **–ï—Å–ª–∏ –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–π –Ω–µ—Ç** ‚Üí –æ—Ç–¥–∞–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª
3. **–ï—Å–ª–∏ —Ñ–∞–π–ª–∞ –Ω–µ—Ç** ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 404

## Response Headers

–°–∏—Å—Ç–µ–º–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏:

```http
X-File-Type: signed|original
X-Contract-Status: uploaded|signed  
X-Short-ID: abc12345
Content-Disposition: attachment; filename=contract_abc12345_signed.pdf
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### Curl —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª–∞
curl -X POST "https://doc.yourcompany.ru/api/v1/upload" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -F "client_id=client123" \
  -F "contract_type=service" \
  -F "file=@contract.pdf"

# –û—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç short_url
{
  "short_url": "https://doc.yourcompany.ru/abc12345"
}

# –°–∫–∞—á–∏–≤–∞–Ω–∏–µ (–æ—Ä–∏–≥–∏–Ω–∞–ª, —Ç–∞–∫ –∫–∞–∫ –µ—â—ë –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω)
curl -L "https://doc.yourcompany.ru/abc12345" -o downloaded.pdf

# –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ
curl -X POST "https://doc.yourcompany.ru/api/v1/sign/65d694a2-20bf-4df8-bff4-72ef9b7eeb7c" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -F "signer_id=signer123" \
  -F "file=@contract_signed.pdf"

# –°–∫–∞—á–∏–≤–∞–Ω–∏–µ (—Ç–µ–ø–µ—Ä—å –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –ø–æ —Ç–æ–π –∂–µ —Å—Å—ã–ª–∫–µ!)
curl -L "https://doc.yourcompany.ru/abc12345" -o downloaded_signed.pdf
```

### SMS —à–∞–±–ª–æ–Ω

```
–î–æ–≥–æ–≤–æ—Ä –≥–æ—Ç–æ–≤ –∫ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—é: https://doc.yourcompany.ru/abc12345
–ü–æ—Å–ª–µ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç—É –∂–µ —Å—Å—ã–ª–∫—É –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ –¥–æ–≥–æ–≤–æ—Ä–∞.
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
–î–æ–±–∞–≤–ª–µ–Ω–æ –Ω–æ–≤–æ–µ –ø–æ–ª–µ `short_id` –≤ —Ç–∞–±–ª–∏—Ü—É `contracts`:
- –¢–∏–ø: VARCHAR(12)
- –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
- –ò–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç—Å—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞

### Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
–î–æ–±–∞–≤–ª–µ–Ω–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å—Å—ã–ª–æ–∫:
```nginx
location ~ ^/([a-z0-9]{8}|[a-f0-9\-]{36})$ {
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å—Å—ã–ª–æ–∫ –∏ –ø–æ–ª–Ω—ã—Ö UUID
}
```

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ü–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∫—ç—à–∏—Ä—É—é—Ç—Å—è –Ω–∞ 5 –º–∏–Ω—É—Ç
- –û—Ä–∏–≥–∏–Ω–∞–ª—ã –Ω–µ –∫—ç—à–∏—Ä—É—é—Ç—Å—è (–º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–º–µ–Ω–µ–Ω—ã)

## –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

–î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–æ–≥–æ–≤–æ—Ä–æ–≤ –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã –∫–æ—Ä–æ—Ç–∫–∏–µ ID –ø—Ä–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.

## –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

‚úÖ –í—Å–µ —Å—Ç–∞—Ä—ã–µ API –æ—Å—Ç–∞—é—Ç—Å—è —Ä–∞–±–æ—á–∏–º–∏:
- `/api/v1/download/{uuid}/original`
- `/api/v1/download/{uuid}/signed`
- –ü–æ–ª–Ω—ã–µ UUID –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ö–æ—Ä–æ—Ç–∫–∏–µ ID –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–º –º–µ—Ç–æ–¥–æ–º
- 8 —Å–∏–º–≤–æ–ª–æ–≤ –¥–∞—é—Ç 2.8 —Ç—Ä–∏–ª–ª–∏–æ–Ω–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- Rate limiting –Ω–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–î–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:
- `X-File-Type` - —Ç–∏–ø –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞
- `X-Contract-Status` - —Å—Ç–∞—Ç—É—Å –¥–æ–≥–æ–≤–æ—Ä–∞
- `X-Short-ID` - –∫–æ—Ä–æ—Ç–∫–∏–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä

## –ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å 1–°

### –ü—Ä–∏–º–µ—Ä 1: –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª–∞ –∫–ª–∏–µ–Ω—Ç—É
```1c
// 1–° –∫–æ–¥
–†–µ–∑—É–ª—å—Ç–∞—Ç = –í—ã–ø–æ–ª–Ω–∏—Ç—å–ó–∞–ø—Ä–æ—ÅHTTP("POST", "upload", –§–∞–π–ª–î–æ–≥–æ–≤–æ—Ä–∞);
–ö–æ—Ä–æ—Ç–∫–∞—è–°—Å—ã–ª–∫–∞ = –†–µ–∑—É–ª—å—Ç–∞—Ç.short_url;

// –û—Ç–ø—Ä–∞–≤–∫–∞ SMS
–û—Ç–ø—Ä–∞–≤–∏—Ç—åSMS(–¢–µ–ª–µ—Ñ–æ–Ω–ö–ª–∏–µ–Ω—Ç–∞, "–î–æ–≥–æ–≤–æ—Ä: " + –ö–æ—Ä–æ—Ç–∫–∞—è–°—Å—ã–ª–∫–∞);
```

### –ü—Ä–∏–º–µ—Ä 2: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–∏
```1c
// –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
–†–µ–∑—É–ª—å—Ç–∞—Ç = –í—ã–ø–æ–ª–Ω–∏—Ç—å–ó–∞–ø—Ä–æ—ÅHTTP("POST", "sign/" + –£–ò–î, –ü–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π–§–∞–π–ª);

// –¢–∞ –∂–µ —Å—Å—ã–ª–∫–∞!
–ö–æ—Ä–æ—Ç–∫–∞—è–°—Å—ã–ª–∫–∞ = –†–µ–∑—É–ª—å—Ç–∞—Ç.short_url;

// –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
–û—Ç–ø—Ä–∞–≤–∏—Ç—åSMS(–¢–µ–ª–µ—Ñ–æ–Ω–ö–ª–∏–µ–Ω—Ç–∞, "–î–æ–≥–æ–≤–æ—Ä –ø–æ–¥–ø–∏—Å–∞–Ω: " + –ö–æ—Ä–æ—Ç–∫–∞—è–°—Å—ã–ª–∫–∞);
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

**Q: –ü–æ—á–µ–º—É —Å—Å—ã–ª–∫–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª –≤–º–µ—Å—Ç–æ –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞?**
A: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –¥–æ–≥–æ–≤–æ—Ä–∞ —á–µ—Ä–µ–∑ `/api/v1/status/{uuid}`. –í–æ–∑–º–æ–∂–Ω–æ, –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –Ω–µ –±—ã–ª –∑–∞–≥—Ä—É–∂–µ–Ω –∏–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞.

**Q: –ö–∞–∫ —É–∑–Ω–∞—Ç—å, –∫–∞–∫–æ–π —Ç–∏–ø —Ñ–∞–π–ª–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è?**
A: –°–º–æ—Ç—Ä–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-File-Type` –≤ –æ—Ç–≤–µ—Ç–µ.

**Q: –†–∞–±–æ—Ç–∞—é—Ç –ª–∏ —Å—Ç–∞—Ä—ã–µ —Å—Å—ã–ª–∫–∏?**
A: –î–∞, –≤—Å–µ —Å—Ç–∞—Ä—ã–µ API –æ—Å—Ç–∞—é—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏.

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–∏—Å–∞.
