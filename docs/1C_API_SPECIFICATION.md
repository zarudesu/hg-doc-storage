# üìã API –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å 1–°

## üîó –ë–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

**Base URL:** `https://contracts.your-domain.com`  
**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** Bearer Token –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization`  
**Content-Type:** `multipart/form-data` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤  
**Timeout:** –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π 30 —Å–µ–∫—É–Ω–¥  

---

## üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

–í—Å–µ –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ endpoints —Ç—Ä–µ–±—É—é—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫:
```http
Authorization: Bearer YOUR_API_KEY_HERE
```

‚ùå **401 Unauthorized** - –Ω–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á  
‚ùå **403 Forbidden** - IP –Ω–µ –≤ whitelist (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω)  
‚ùå **429 Too Many Requests** - –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç (100 req/min)

---

## üì° API Endpoints

### 1. üîí POST /api/v1/upload
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –¥–æ–≥–æ–≤–æ—Ä–∞ –æ—Ç 1–°

**–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
```http
Authorization: Bearer YOUR_API_KEY
Content-Type: multipart/form-data
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–æ—Ä–º—ã:**
- `client_id` (string, required) - –•–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π ID –∫–ª–∏–µ–Ω—Ç–∞
- `contract_type` (string, required) - –¢–∏–ø –¥–æ–≥–æ–≤–æ—Ä–∞
- `file` (file, required) - PDF —Ñ–∞–π–ª

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```http
POST /api/v1/upload
Authorization: Bearer abc123...
Content-Type: multipart/form-data

--boundary123
Content-Disposition: form-data; name="client_id"

CLIENT_456789
--boundary123
Content-Disposition: form-data; name="contract_type"

surgery
--boundary123
Content-Disposition: form-data; name="file"; filename="contract.pdf"
Content-Type: application/pdf

[PDF binary data]
--boundary123--
```

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200):**
```json
{
  "contract_id": "550e8400-e29b-41d4-a716-446655440000",
  "file_url": "https://contracts.your-domain.com/api/v1/download/550e8400-e29b-41d4-a716-446655440000/original",
  "message": "File uploaded successfully"
}
```

**–û—à–∏–±–∫–∏:**
- `400` - –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø —Ñ–∞–π–ª–∞ –∏–ª–∏ —Ä–∞–∑–º–µ—Ä > 50MB
- `401` - –ù–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á
- `500` - –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

---

### 2. üîí POST /api/v1/sign/{contract_id}
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ –¥–æ–≥–æ–≤–æ—Ä–∞

**URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `contract_id` (UUID) - ID –¥–æ–≥–æ–≤–æ—Ä–∞ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

**–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
```http
Authorization: Bearer YOUR_API_KEY
Content-Type: multipart/form-data
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–æ—Ä–º—ã:**
- `signer_id` (string, required) - –•–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π ID –ø–æ–¥–ø–∏—Å–∞–≤—à–µ–≥–æ
- `file` (file, required) - –ü–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π PDF —Ñ–∞–π–ª

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```http
POST /api/v1/sign/550e8400-e29b-41d4-a716-446655440000
Authorization: Bearer abc123...
Content-Type: multipart/form-data

--boundary123
Content-Disposition: form-data; name="signer_id"

SIGNER_789123
--boundary123
Content-Disposition: form-data; name="file"; filename="signed.pdf"
Content-Type: application/pdf

[Signed PDF binary data]
--boundary123--
```

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200):**
```json
{
  "contract_id": "550e8400-e29b-41d4-a716-446655440000",
  "signed_file_url": "https://contracts.your-domain.com/api/v1/download/550e8400-e29b-41d4-a716-446655440000/signed",
  "message": "File signed successfully"
}
```

**–û—à–∏–±–∫–∏:**
- `400` - –î–æ–≥–æ–≤–æ—Ä —É–∂–µ –ø–æ–¥–ø–∏—Å–∞–Ω –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–∞–π–ª
- `404` - –î–æ–≥–æ–≤–æ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω
- `401` - –ù–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á

---

### 3. üîí GET /api/v1/status/{contract_id}
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –¥–æ–≥–æ–≤–æ—Ä–∞

**–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
```http
Authorization: Bearer YOUR_API_KEY
```

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200):**
```json
{
  "contract_id": "550e8400-e29b-41d4-a716-446655440000",
  "client_id": "CLIENT_456789",
  "contract_type": "surgery",
  "status": "signed",
  "original_file_url": "https://contracts.your-domain.com/api/v1/download/550e8400-e29b-41d4-a716-446655440000/original",
  "signed_file_url": "https://contracts.your-domain.com/api/v1/download/550e8400-e29b-41d4-a716-446655440000/signed",
  "created_at": "2025-08-15T10:30:00Z",
  "signed_at": "2025-08-15T11:45:00Z",
  "signer_id": "SIGNER_789123"
}
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã:**
- `uploaded` - –ó–∞–≥—Ä—É–∂–µ–Ω –æ—Ä–∏–≥–∏–Ω–∞–ª, –∂–¥–µ—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è
- `signed` - –î–æ–≥–æ–≤–æ—Ä –ø–æ–¥–ø–∏—Å–∞–Ω

---

### 4. üì• GET /api/v1/download/{contract_id}/{file_type}
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—É–±–ª–∏—á–Ω–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ (–ë–ï–ó API –∫–ª—é—á–∞)

**URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `contract_id` (UUID) - ID –¥–æ–≥–æ–≤–æ—Ä–∞
- `file_type` (string) - `original` –∏–ª–∏ `signed`

**–û—Ç–≤–µ—Ç:** –ë–∏–Ω–∞—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ PDF —Ñ–∞–π–ª–∞
```http
HTTP/1.1 200 OK
Content-Type: application/pdf
Content-Disposition: attachment; filename=contract_UUID_original.pdf
Cache-Control: no-cache, no-store, must-revalidate

[PDF binary data]
```

**–û—à–∏–±–∫–∏:**
- `404` - –î–æ–≥–æ–≤–æ—Ä –∏–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω
- `404` - –ü–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (–µ—Å–ª–∏ —Å—Ç–∞—Ç—É—Å `uploaded`)

---

## üõ°Ô∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –¥–∞–Ω–Ω—ã–º

### –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚ùó **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** —Ö–µ—à–∏—Ä—É–π—Ç–µ –ü–î–Ω –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π:

```
client_id = "CLIENT_" + HASH(–§–ò–û + –î–∞—Ç–∞–†–æ–∂–¥–µ–Ω–∏—è + –ù–æ–º–µ—Ä–î–æ–∫—É–º–µ–Ω—Ç–∞) % 1000000
signer_id = "SIGNER_" + HASH(–§–ò–û–í—Ä–∞—á–∞ + –î–æ–ª–∂–Ω–æ—Å—Ç—å + –õ–∏—Ü–µ–Ω–∑–∏—è–í—Ä–∞—á–∞) % 1000000
```

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤
- **–¢–∏–ø:** –¢–æ–ª—å–∫–æ PDF
- **–†–∞–∑–º–µ—Ä:** –ú–∞–∫—Å–∏–º—É–º 50MB
- **–ö–æ–¥–∏—Ä–æ–≤–∫–∞:** UTF-8

---

## üìä –ö–æ–¥—ã –æ—à–∏–±–æ–∫ HTTP

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ | –î–µ–π—Å—Ç–≤–∏–µ |
|-----|----------|----------|
| 200 | –£—Å–ø–µ—Ö | –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å |
| 400 | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ |
| 401 | –ù–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–ª—é—á |
| 403 | IP –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω | –°–≤—è–∑–∞—Ç—å—Å—è —Å –∞–¥–º–∏–Ω–æ–º |
| 404 | –ù–µ –Ω–∞–π–¥–µ–Ω–æ | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å UUID |
| 413 | –§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π | –£–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑–º–µ—Ä |
| 429 | –õ–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ | –ü–æ–¥–æ–∂–¥–∞—Ç—å 1 –º–∏–Ω—É—Ç—É |
| 500 | –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ | –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–∑–∂–µ |

---

## üîÑ –¢–∏–ø–∏—á–Ω—ã–π workflow

1. **1–° —Å–æ–∑–¥–∞–µ—Ç –¥–æ–≥–æ–≤–æ—Ä** ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç `POST /api/v1/upload`
2. **–ü–æ–ª—É—á–∞–µ—Ç UUID –∏ —Å—Å—ã–ª–∫—É** ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –±–∞–∑–µ 1–°
3. **–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å—Å—ã–ª–∫—É –∫–ª–∏–µ–Ω—Ç—É** ‚Üí email/SMS —Å `file_url`
4. **–í—Ä–∞—á –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç** ‚Üí 1–° –≤—ã–∑—ã–≤–∞–µ—Ç `POST /api/v1/sign/{uuid}`
5. **–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é** ‚Üí email/SMS —Å `signed_file_url`

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Health Check (–±–µ–∑ API –∫–ª—é—á–∞):
```http
GET /health
‚Üí {"status": "healthy", "service": "1C Contract Service"}
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ API –∫–ª—é—á–∞:
```http
GET /api/v1/status/00000000-0000-0000-0000-000000000000
Authorization: Bearer YOUR_KEY
‚Üí 404 (–∫–ª—é—á –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π) –∏–ª–∏ 401 (–Ω–µ–≤–µ—Ä–Ω—ã–π –∫–ª—é—á)
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

1. **UUID —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ 1–°** - –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
2. **–ü—É–±–ª–∏—á–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã** - UUID –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —É–≥–∞–¥–∞—Ç—å
3. **Rate limiting** - –Ω–µ –±–æ–ª–µ–µ 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É —Å –æ–¥–Ω–æ–≥–æ IP
4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
5. **Timeout** - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ 30+ —Å–µ–∫—É–Ω–¥ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤

---

## üìû –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞

- üîß **Health Check:** `GET /health`
- üìß **Email:** tech@hg-doc-storage.com  
- üé´ **Issues:** GitHub Issues –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞

---

*API Version: 1.0.0*  
*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–∞ –Ω–∞: 15.08.2025*